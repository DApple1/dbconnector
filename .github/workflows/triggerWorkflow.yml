name: TRIGGER WORKFLOW
on: 
  workflow_dispatch:
    inputs:
      deployTo: 
        description: 'Environment to deploy to'
        required: true
        default: dev
      bump:
        description: 'Choose between: patch, minor, major'
        required: true
        default: patch

env:
  ENVIRONMENT: dev

jobs:
  workflowTrigger:
    if: contains(github.ref, 'master') || contains(github.event.inputs.deployTo, 'dev')

    runs-on: ubuntu-latest
    steps:

      - name: Checkout
        uses: actions/checkout@master

      # Get branch name to use for tag
      - name: Extract Branch Name
        run: |
          echo "::set-env name=TAG_NAME::$(echo ${GITHUB_REF##*/})"
            
      - name: Echo values
        run: |
          echo "Environment: ${{ github.event.inputs.deployTo }}"
          echo "Tag: $TAG_NAME"

      - name: SHA
        run: |
          echo "${{github.sha}}"

      - name: Bump version and push tag
        uses: anothrNick/github-tag-action@1.17.2
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          DEFAULT_BUMP: ${{ github.event.inputs.bump }}
          WITH_V: true
          INITIAL_VERSION: 1.0.0

